knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.align = 'left')
knitr::opts_knit$set(root.dir = '../data')
options(width = 88, scipen = 4)
hetero=read.csv("sampleHeterozygosity.csv")
heteroStat <- ddply(hetero, c("popdepth"), summarise,
N    = length(Heterozygosity),
mean = mean(Heterozygosity),
sd   = sd(Heterozygosity),
se   = sd / sqrt(N))
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra", "paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP", "tidyverse", "vcfR", "vegan", "WGCNA", "boa", "plyr")
hetero=read.csv("sampleHeterozygosity.csv")
heteroStat <- ddply(hetero, c("popdepth"), summarise,
N    = length(Heterozygosity),
mean = mean(Heterozygosity),
sd   = sd(Heterozygosity),
se   = sd / sqrt(N))
max(heteroStat$mean, na.rm = TRUE)
min(heteroStat$mean, na.rm = TRUE)
heteroStat
max(heteroStat$mean, na.rm = TRUE)
source('plot_R.r')
#install.packages("boa")
library(boa)
source('plot_R.r')
dat = read.table("fkMcav.baye_fst.txt",header=T)
getwd()
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.align = 'left')
knitr::opts_knit$set(root.dir = '../data')
options(width = 88, scipen = 4)
setwd('../data')
getwd()
setwd('../data')
getwd()
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.align = 'left')
knitr::opts_knit$set(root.dir = '../data')
options(width = 88, scipen = 4)
setwd('../data')
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra", "paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP", "tidyverse", "vcfR", "vegan", "WGCNA", "boa", "plyr")
source('plot_R.r')
getwd()
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.align = 'left')
knitr::opts_knit$set(root.dir = '../data')
options(width = 88, scipen = 4)
if (!require("pacman")) install.packages("pacman")
pacman::p_load("adegenet", "dendextend", "flextable", "gdata", "ggdendro", "hierfstat", "Imap", "kableExtra", "paletteer", "patchwork", "officer", "poppr", "RColorBrewer", "reshape2", "StAMPP", "tidyverse", "vcfR", "vegan", "WGCNA", "boa", "plyr", "rgdal", "broom", "rgeos", "ggmap", "moments", "car", "multcompView", "lsmeans")
packageVersion()
packageVersion("vegan")
packageVersion("poppr")
packageVersion("stamppfst")
packageVersion("stamppFst")
packageVersion("StAMPP")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.align = 'left')
knitr::opts_knit$set(root.dir = '../data')
options(width = 88, scipen = 4)
fkVcf = read.vcfR("fkMcavNoClonesRenamed.vcf.gz")
locNames(fkGenlightPopDepth) = paste(fkVcf@fix[,1],fkVcf@fix[,2],sep="_")
fkGenlightPopDepth = vcfR2genlight(fkVcf, n.cores = 2) # Converts the vcf file into a file format that poppr uses the "genlight" format
locNames(fkGenlightPopDepth) = paste(fkVcf@fix[,1],fkVcf@fix[,2],sep="_")
popData = read.csv("inds2popsNoClonesPopDepth.csv") # Reads in population data for each sample
strata(fkGenlightPopDepth) = data.frame(popData)
setPop(fkGenlightPopDepth) = ~popdepth
fkGenlightPopDepth
pca.1 <- glPca(fkGenlightPopDepth, nf=300, n.cores=1)
# proportion of explained variance by first three axes
pca.1$eig[1]/sum(pca.1$eig) # proportion of variation explained by 1st axis
pca.1$eig[2]/sum(pca.1$eig) # proportion of variation explained by 2nd axis
pca.1$eig[3]/sum(pca.1$eig) # proportion of variation explained by 3rd axis
#####K-Means Clustering and DAPC
grp <- find.clusters(fkGenlightPopDepth, max.n.clust=11, glPca = pca.1, perc.pca = 100, n.iter=1e6, n.start=1000)
