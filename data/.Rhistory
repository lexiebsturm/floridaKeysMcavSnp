geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right")+
scale_x_discrete(labels = str_wrap(snpFst$Pop, width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
ggsave("../figures/snpHeatMap.tiff", plot = snpHeatmap, width = 34, height = 15, units = "cm", dpi = 300)
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("UK-Shallow", "LK-Mesophotic", "LK-Shallow", "DRT-N-Mesophotic", "DRT-N-Shallow", "DRT-S-Shallow", "DRT-S-Mesophotic"))+
scale_x_discrete(labels = str_wrap(snpFst$Pop, width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("UK-Shallow", "LK-Mesophotic", "LK-Shallow", "DRT-N-Mesophotic", "DRT-N-Shallow", "DRT-S-Shallow", "DRT-S-Mesophotic"))+
scale_x_discrete(labels = str_wrap(snpFst$Pop, width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Mesophotic","DRT-S-Shallow", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = str_wrap(snpFst$Pop, width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow","DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = str_wrap(snpFst$Pop, width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
#install.packages("boa")
library(boa)
source('plot_R.r')
dat = read.table("fkMcav.baye_fstAbsDepth.txt",header=T)
head(dat)
table(dat[,"qval_g"]<0.1)
outsDepth=which(dat[,"qval_g"]<0.1)
head(dat)
dat %>% filter(qval_g < 0.1)
dat
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow","DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = str_wrap(c("DRT-S-Shallow","DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"), width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = c("DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic")) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = c("DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic")) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow", "DRT-N-Mesophotic", "LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic"), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
df <- read.csv("fkMcavNoClones_k4.csv")
df$sample <- factor(df$sample, levels= df$sample[order(-df$cluster4, df$cluster2)])
mdat = melt(df, id.vars=c("sample", "pop"), variable.name="Ancestry", value.name="Fraction")
mdat$pop = factor(mdat$pop, levels(mdat$pop)[c(6,5,4,3,2,1,8,7)])
p = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry)) +
geom_bar(stat="identity", position="stack") +
facet_grid(. ~ pop, drop=TRUE, space="free", scales="free")
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow", "DRT-N-Mesophotic", "LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic"), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow", "DRT-N-Mesophotic", "LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic")), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
p2
label=c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow", "DRT-N-Mesophotic", "LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic")
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = label, scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
mdat$pop = factor(mdat$pop, levels(mdat$pop)[c(6,5,4,3,2,1,8,7)])
mdat$pop
levels(mdat$pop)
labels = c(Lower Keys-Mesophotic="LK-Mesophotic",
labels = c("Lower Keys-Mesophotic"="LK-Mesophotic",
"Lower Keys-Shallow"="LK-Shallow",
"TER-North-Mesophotic"="DRT-N-Mesophotic",
"TER-North-Shallow"="DRT-N-Shallow",
"TER-South-Mesophotic"="DRT-S-Mesophotic",
"TER-South-Shallow"="DRT-South-Mesophotic",
"Upper Keys-Mesophotic"="UK-Mesophotic",
"Upper Keys-Shallow"="UK-Shallow")
labels = c("Lower Keys-Mesophotic"="LK-Mesophotic",
"Lower Keys-Shallow"="LK-Shallow",
"TER-North-Mesophotic"="DRT-N-Mesophotic",
"TER-North-Shallow"="DRT-N-Shallow",
"TER-South-Mesophotic"="DRT-S-Mesophotic",
"TER-South-Shallow"="DRT-South-Mesophotic",
"Upper Keys-Mesophotic"="UK-Mesophotic",
"Upper Keys-Shallow"="UK-Shallow")
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(pop = labels), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
mdat$pop = factor(mdat$pop, levels(mdat$pop)[c(6,5,4,3,2,1,8,7)])
df <- read.csv("fkMcavNoClones_k4.csv")
df$sample <- factor(df$sample, levels= df$sample[order(-df$cluster4, df$cluster2)])
mdat = melt(df, id.vars=c("sample", "pop"), variable.name="Ancestry", value.name="Fraction")
mdat$pop = factor(mdat$pop, levels(mdat$pop)[c(6,5,4,3,2,1,8,7)])
labels = c("Lower Keys-Mesophotic"="LK-Mesophotic",
"Lower Keys-Shallow"="LK-Shallow",
"TER-North-Mesophotic"="DRT-N-Mesophotic",
"TER-North-Shallow"="DRT-N-Shallow",
"TER-South-Mesophotic"="DRT-S-Mesophotic",
"TER-South-Shallow"="DRT-South-Mesophotic",
"Upper Keys-Mesophotic"="UK-Mesophotic",
"Upper Keys-Shallow"="UK-Shallow")
p = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry)) +
geom_bar(stat="identity", position="stack") +
facet_grid(. ~ pop, drop=TRUE, space="free", scales="free")
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(pop = labels), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
df <- read.csv("fkMcavNoClones_k4.csv")
df$sample <- factor(df$sample, levels= df$sample[order(-df$cluster4, df$cluster2)])
mdat = melt(df, id.vars=c("sample", "pop"), variable.name="Ancestry", value.name="Fraction")
mdat$pop = factor(mdat$pop, levels(mdat$pop)[c(6,5,4,3,2,1,8,7)])
labels = c("Lower Keys-Mesophotic"="LK-Mesophotic",
"Lower Keys-Shallow"="LK-Shallow",
"TER-North-Mesophotic"="DRT-N-Mesophotic",
"TER-North-Shallow"="DRT-N-Shallow",
"TER-South-Mesophotic"="DRT-S-Mesophotic",
"TER-South-Shallow"="DRT-S-Shallow",
"Upper Keys-Mesophotic"="UK-Mesophotic",
"Upper Keys-Shallow"="UK-Shallow")
p = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry)) +
geom_bar(stat="identity", position="stack") +
facet_grid(. ~ pop, drop=TRUE, space="free", scales="free")
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(pop = labels), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12, angle=90),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
ggsave("../figures/admixturePlot.tiff", plot = p2, width = 30, height = 15, units = "cm", dpi = 300)
ggsave("../figures/fkSnpPcoaPlot.tiff", plot = fkSnpPcoaPlot, height = 5, width = 7, units = "in", dpi = 300)
ggsave("../figures/snpHeatMap.tiff", plot = snpHeatmap, width = 34, height = 15, units = "cm", dpi = 300)
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(str_wrap(labels = c("DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic")), width=6) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmapA = ggplot(data = snpFst, aes(Pop, Pop2, fill = Fst))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", midpoint = 0, limit = c(0, 0.1),
space = "Lab", name = expression(paste(italic("F")[ST])))+
geom_text(data = snpFst, aes(Pop, Pop2, label = Fst), color = ifelse(snpQ$Qval <= 0.05,"black", "darkgrey"), size = ifelse(snpQ$Qval < 0.05, 6, 5)) +
guides(fill=guide_colorbar(barwidth = 1, barheight = 12, title.position = "top", title.hjust = 0.5))+
scale_y_discrete(position = "right", labels=c("DRT-S-Shallow", "DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow"))+
scale_x_discrete(labels = str_wrap(c("DRT-S-Mesophotic", "DRT-N-Shallow","DRT-N-Mesophotic","LK-Shallow", "LK-Mesophotic", "UK-Shallow", "UK-Mesophotic"), width = 6)) +
#ggtitle("   SNP") +
theme_minimal()
snpHeatmap = snpHeatmapA + theme(
axis.text.x = element_text(vjust = 1, size = 16, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.direction = "vertical",
legend.title = element_text(size = 16),
legend.text = element_text(size = 14),
plot.title = element_text(size = 16)
)
snpHeatmap
ggsave("../figures/snpHeatMap.tiff", plot = snpHeatmap, width = 34, height = 15, units = "cm", dpi = 300)
ggsave("../figures/admixturePlot.tiff", plot = p2, width = 30, height = 15, units = "cm", dpi = 300)
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(pop = labels), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=12),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
p2 = ggplot(mdat, aes(x=sample, y=Fraction, fill=Ancestry, order=sample)) +
geom_bar(stat="identity", position="fill", width=1, colour="grey25") +
facet_grid(~pop, labeller = labeller(pop = labels), scales = "free", switch = "x", space = "free") +
labs(x = "Population", y = "Ancestry") +
ggtitle("K4 NGSAdmixture Plot") +
theme(plot.title = element_text(hjust = 0.5),
panel.grid=element_blank(),
panel.background=element_rect(fill=NA, colour="grey25"),
panel.spacing.x=grid:::unit(0, "lines"),
panel.border = element_rect(fill=NA,color="black", size=2, linetype="solid"),
#axis.text.x=element_text(size=12, angle=90)
axis.text.x = element_blank(),
axis.ticks.x=element_blank(),
strip.background=element_blank(),
strip.text=element_text(size=10),
legend.key=element_blank(),
legend.position = "none",
legend.title = element_blank()) +
scale_x_discrete(expand=c(0, 0)) +
scale_y_continuous(expand=c(0, 0)) +
scale_fill_manual(values = brewer.pal(name = "YlGnBu", n = 4), name = "Cluster") +
guides(fill=guide_legend(override.aes=list(colour=NULL)))
p2
setwd("/Users/student/Documents/Spring\ 2020/Florida\ Keys/Maps")
setwd("/Users/student/Documents/Spring\ 2020/Florida\ Keys/Maps")
if (!require("pacman")) install.packages("pacman")
setwd("/Users/student/Documents/Spring\ 2020/Florida\ Keys/Maps")
