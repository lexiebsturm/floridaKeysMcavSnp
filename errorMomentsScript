#Script at the following repository: https://github.com/z0on/AFS-analysis-with-moments/blob/master/momens_scripts_README.txt

cd /home/asturm2017/2bRAD/floridaKeys/fkSFSAnalysisSfilt

# ------ multimodel inference: fit a diversity of 2-population models, then select the best one based on AIC.
# there are models with a period of exponential growth ("IM" models), models with one, two or three different size and/or migration rate epochs ("SC" models, including models with no migration in some epochs), models with symmetrical migration ("sm" models, in other cases migration is asymmetrical), models with two types of genomic loci ("genomic islands") introgressing at different rates ("i" models), and some fun combinations thereof.
# differences between models are summarized in excel table moments_multimodels.xls

# read about multimodel inference here:
# https://pdfs.semanticscholar.org/a696/9a3b5720162eaa75deec3a607a9746dae95e.pdf

# this HAS to be parallelized - we need to fit ~100 models 5 times to make sure each model converges at its best fit at least once.

nano allmodels_folded

fold_IM.py
fold_IMi.py
fold_IMisc.py
fold_IMisc2.py
fold_IMisc2sm.py
fold_IMiscsm.py
fold_IMiscsmB.py
fold_IMism.py
fold_IMnm.py
fold_IMns.py
fold_IMsc.py
fold_IMsc2.py
fold_IMsc2sm.py
fold_IMscnm.py
fold_IMscns.py
fold_IMscsm.py
fold_IMsm.py
fold_SC1.py
fold_SC11.py
fold_SC11nm.py
fold_SC11sm.py
fold_SC12il.py
fold_SC12ilsm.py
fold_SC12im.py
fold_SC12iml.py
fold_SC12imlsm.py
fold_SC12imlsm1.py
fold_SC12imlsm2.py
fold_SC12imsm.py
fold_SC12nm.py
fold_SC1e.py
fold_SC1esm.py
fold_SC1i.py
fold_SC1ie.py
fold_SC1ielsm1.py
fold_SC1ielsm2.py
fold_SC1iesm.py
fold_SC1il.py
fold_SC1ilsm.py
fold_SC1l.py
fold_SC1lsm.py
fold_SC1nm.py
fold_SC1ns.py
fold_SC1sm1.py
fold_SC1sm2.py
fold_SC2.py
fold_SC21nm.py
fold_SC2e.py
fold_SC2el.py
fold_SC2elsm.py
fold_SC2esm.py
fold_SC2i.py
fold_SC2ie.py
fold_SC2iel.py
fold_SC2ielsm.py
fold_SC2ielsm1.py
fold_SC2ielsm2.py
fold_SC2iesm.py
fold_SC2il.py
fold_SC2ilsm.py
fold_SC2l.py
fold_SC2lsm.py
fold_SC2ns.py
fold_SC2sm1.py
fold_SC2sm2.py
fold_SC3e.py
fold_SC3el.py
fold_SC3el2.py
fold_SC3elsm.py
fold_SC3em.py
fold_SC3em2.py
fold_SC3eml.py
fold_SC3emlsm.py
fold_SC3emsm.py
fold_SC3esm.py
fold_SC3ie.py
fold_SC3iel.py
fold_SC3ielsm.py
fold_SC3ielsm1.py
fold_SC3ielsm2.py
fold_SC3iem.py
fold_SC3ieml.py
fold_SC3iemlsm.py
fold_SC3iemsm.py
fold_SC3iemsm1.py
fold_SC3iemsm2.py
fold_SC3iesm.py
fold_SC3il.py
fold_SC3ilsm.py
fold_SC3im.py
fold_SC3iml.py
fold_SC3imlsm.py
fold_SC3imlsm1.py
fold_SC3imlsm2.py
fold_SC3imsm.py
fold_SC3l.py
fold_SC3lsm.py
fold_SC3m.py
fold_SC3ml.py
fold_SC3ml2.py
fold_SC3mlsm.py
fold_SC3msm.py
fold_SC3nm.py
fold_SC3ns.py
fold_s2m.py
fold_s2mi.py
fold_s2mismB.py
fold_s2msm.py

# running all models on the same data NREPS times, to ensure convergence
# input line: the last four numbers are:
# - projections (2 x 0.9 x number of samples) for in each pop;
# - mutation rate per gamete per generation
# - generation time, in thousand years
ARGS="01pops_dadi.data pop0 pop1 22 54 0.02 0.005"
NREPS=5
>am
for i in `seq 1 $NREPS`;do
#
cat allmodels_folded >>am;
done
NMODELS=`cat am | wc -l`
>args
for i in `seq 1 $NMODELS`; do
echo $ARGS >>args;
done
paste am args -d " " >ama

launcher_creator.py -j ama -n ama -t 2:00:00 -e asturm2017@fau.edu -q shortq7 -N 5
sbatch ama.slurm
